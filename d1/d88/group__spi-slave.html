<!-- HTML header for doxygen 1.8.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>OpenThread: SPI Slave</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../Open-Thread-Logo-200x42.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">
   &#160;<span id="projectnumber">gddd0704</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('d1/d88/group__spi-slave.html','../../');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">SPI Slave<div class="ingroups"><a class="el" href="../../de/d8b/group__platform.html">Platform Abstraction</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>This module includes the platform abstraction for SPI slave communication.  
<a href="#details">More...</a></p>
<div class="dynheader">
Collaboration diagram for SPI Slave:</div>
<div class="dyncontent">
<center><table><tr><td><img src="../../d1/d88/group__spi-slave.png" border="0" alt="" usemap="#d1_2d88_2group____spi-slave"/>
<map name="d1_2d88_2group____spi-slave" id="d1_2d88_2group____spi-slave">
<area shape="rect" id="node2" href="../../de/d8b/group__platform.html" title="This module includes the platform abstraction used by the OpenThread stack. " alt="" coords="5,5,146,31"/>
</map>
</td></tr></table></center>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:gaed8c26f734d3a2ba4ec543e9e94a0cf2"><td class="memItemLeft" align="right" valign="top">typedef void(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d88/group__spi-slave.html#gaed8c26f734d3a2ba4ec543e9e94a0cf2">otPlatSpiSlaveTransactionCompleteCallback</a>) (void *aContext, uint8_t *anOutputBuf, uint16_t anOutputBufLen, uint8_t *anInputBuf, uint16_t anInputBufLen, uint16_t aTransactionLength)</td></tr>
<tr class="memdesc:gaed8c26f734d3a2ba4ec543e9e94a0cf2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Indicates that a SPI transaction has completed with the given length.  <a href="#gaed8c26f734d3a2ba4ec543e9e94a0cf2">More...</a><br /></td></tr>
<tr class="separator:gaed8c26f734d3a2ba4ec543e9e94a0cf2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gab202b9e8a3a12e7e738467c4693acd44"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dc/dbf/openthread-types_8h.html#ab701d053a9c34ab7f11e43e0dc09ac9f">ThreadError</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d88/group__spi-slave.html#gab202b9e8a3a12e7e738467c4693acd44">otPlatSpiSlaveEnable</a> (<a class="el" href="../../d1/d88/group__spi-slave.html#gaed8c26f734d3a2ba4ec543e9e94a0cf2">otPlatSpiSlaveTransactionCompleteCallback</a> aCallback, void *aContext)</td></tr>
<tr class="memdesc:gab202b9e8a3a12e7e738467c4693acd44"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize the SPI slave interface.  <a href="#gab202b9e8a3a12e7e738467c4693acd44">More...</a><br /></td></tr>
<tr class="separator:gab202b9e8a3a12e7e738467c4693acd44"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3b386f4b585e8deafa475c873d13a532"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga3b386f4b585e8deafa475c873d13a532"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d88/group__spi-slave.html#ga3b386f4b585e8deafa475c873d13a532">otPlatSpiSlaveDisable</a> (void)</td></tr>
<tr class="memdesc:ga3b386f4b585e8deafa475c873d13a532"><td class="mdescLeft">&#160;</td><td class="mdescRight">Shutdown and disable the SPI slave interface. <br /></td></tr>
<tr class="separator:ga3b386f4b585e8deafa475c873d13a532"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga545203c4c963f46b40586b830d817a45"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dc/dbf/openthread-types_8h.html#ab701d053a9c34ab7f11e43e0dc09ac9f">ThreadError</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d88/group__spi-slave.html#ga545203c4c963f46b40586b830d817a45">otPlatSpiSlavePrepareTransaction</a> (uint8_t *anOutputBuf, uint16_t anOutputBufLen, uint8_t *anInputBuf, uint16_t anInputBufLen, bool aRequestTransactionFlag)</td></tr>
<tr class="memdesc:ga545203c4c963f46b40586b830d817a45"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prepare data for the next SPI transaction.  <a href="#ga545203c4c963f46b40586b830d817a45">More...</a><br /></td></tr>
<tr class="separator:ga545203c4c963f46b40586b830d817a45"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>This module includes the platform abstraction for SPI slave communication. </p>
<h2 class="groupheader">Typedef Documentation</h2>
<a class="anchor" id="gaed8c26f734d3a2ba4ec543e9e94a0cf2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef void(* otPlatSpiSlaveTransactionCompleteCallback) (void *aContext, uint8_t *anOutputBuf, uint16_t anOutputBufLen, uint8_t *anInputBuf, uint16_t anInputBufLen, uint16_t aTransactionLength)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Indicates that a SPI transaction has completed with the given length. </p>
<p>The data written to the slave has been written to the pointer indicated by the <code>anInputBuf</code> argument to the previous call to <a class="el" href="../../d1/d88/group__spi-slave.html#ga545203c4c963f46b40586b830d817a45" title="Prepare data for the next SPI transaction. ">otPlatSpiSlavePrepareTransaction()</a>.</p>
<p>Once this function is called, <a class="el" href="../../d1/d88/group__spi-slave.html#ga545203c4c963f46b40586b830d817a45" title="Prepare data for the next SPI transaction. ">otPlatSpiSlavePrepareTransaction()</a> is invalid and must be called again for the next transaction to be valid.</p>
<p>Note that this function is always called at the end of a transaction, even if <a class="el" href="../../d1/d88/group__spi-slave.html#ga545203c4c963f46b40586b830d817a45" title="Prepare data for the next SPI transaction. ">otPlatSpiSlavePrepareTransaction()</a> has not yet been called. In such cases, anOutputBufLen and anInputBufLen will be zero.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">aContext</td><td>Context pointer passed into <a class="el" href="../../d1/d88/group__spi-slave.html#gab202b9e8a3a12e7e738467c4693acd44" title="Initialize the SPI slave interface. ">otPlatSpiSlaveEnable()</a> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">anOutputBuf</td><td>Value of anOutputBuf from last call to <a class="el" href="../../d1/d88/group__spi-slave.html#ga545203c4c963f46b40586b830d817a45" title="Prepare data for the next SPI transaction. ">otPlatSpiSlavePrepareTransaction()</a> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">anOutputBufLen</td><td>Value of anOutputBufLen from last call to <a class="el" href="../../d1/d88/group__spi-slave.html#ga545203c4c963f46b40586b830d817a45" title="Prepare data for the next SPI transaction. ">otPlatSpiSlavePrepareTransaction()</a> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">anInputBuf</td><td>Value of anInputBuf from last call to <a class="el" href="../../d1/d88/group__spi-slave.html#ga545203c4c963f46b40586b830d817a45" title="Prepare data for the next SPI transaction. ">otPlatSpiSlavePrepareTransaction()</a> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">anInputBufLen</td><td>Value of anInputBufLen from last call to <a class="el" href="../../d1/d88/group__spi-slave.html#ga545203c4c963f46b40586b830d817a45" title="Prepare data for the next SPI transaction. ">otPlatSpiSlavePrepareTransaction()</a> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">aTransactionLength</td><td>Length of the completed transaction, in bytes </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="gab202b9e8a3a12e7e738467c4693acd44"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dc/dbf/openthread-types_8h.html#ab701d053a9c34ab7f11e43e0dc09ac9f">ThreadError</a> otPlatSpiSlaveEnable </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d1/d88/group__spi-slave.html#gaed8c26f734d3a2ba4ec543e9e94a0cf2">otPlatSpiSlaveTransactionCompleteCallback</a>&#160;</td>
          <td class="paramname"><em>aCallback</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>aContext</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize the SPI slave interface. </p>
<p>Note that the SPI slave is not fully ready until a transaction is prepared using otPlatSPISlavePrepareTransaction().</p>
<p>If otPlatSPISlavePrepareTransaction() is not called before the master begins a transaction, the resulting SPI transaction will send all <code>0xFF</code> bytes and discard all received bytes.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">aCallback</td><td>Pointer to transaction complete callback </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">aContext</td><td>Context pointer to be passed to transaction complete callback</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">::kThreadError_None</td><td>Successfully enabled the SPI Slave interface. </td></tr>
    <tr><td class="paramname"><a class="el" href="../../dc/dbf/openthread-types_8h.html#ab701d053a9c34ab7f11e43e0dc09ac9fa58419c21193b24de982729f153fcab76" title="The operation is already in progress. ">kThreadError_Already</a></td><td>SPI Slave interface is already enabled. </td></tr>
    <tr><td class="paramname">::kThreadError_Failed</td><td>Failed to enable the SPI Slave interface. </td></tr>
  </table>
  </dd>
</dl>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d1/d88/group__spi-slave_gab202b9e8a3a12e7e738467c4693acd44_icgraph.png" border="0" usemap="#d1/d88/group__spi-slave_gab202b9e8a3a12e7e738467c4693acd44_icgraph" alt=""/></div>
<map name="d1/d88/group__spi-slave_gab202b9e8a3a12e7e738467c4693acd44_icgraph" id="d1/d88/group__spi-slave_gab202b9e8a3a12e7e738467c4693acd44_icgraph">
<area shape="rect" id="node2" href="../../d0/d2a/classThread_1_1NcpSpi.html#a755449adff7ec14f4985ac462c7914bd" title="Constructor. " alt="" coords="203,5,367,31"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga545203c4c963f46b40586b830d817a45"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dc/dbf/openthread-types_8h.html#ab701d053a9c34ab7f11e43e0dc09ac9f">ThreadError</a> otPlatSpiSlavePrepareTransaction </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>anOutputBuf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>anOutputBufLen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>anInputBuf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>anInputBufLen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>aRequestTransactionFlag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Prepare data for the next SPI transaction. </p>
<p>Data pointers MUST remain valid until the transaction complete callback is called by the SPI slave driver, or until after the next call to <a class="el" href="../../d1/d88/group__spi-slave.html#ga545203c4c963f46b40586b830d817a45" title="Prepare data for the next SPI transaction. ">otPlatSpiSlavePrepareTransaction()</a>.</p>
<p>This function may be called more than once before the SPI master initiates the transaction. Each <em>successful</em> call to this function will cause the previous values from earlier calls to be discarded.</p>
<p>Not calling this function after a completed transaction is the same as if this function was previously called with both buffer lengths set to zero and aRequestTransactionFlag set to <code>false</code>.</p>
<p>Once anOutputBufLen bytes of anOutputBuf has been clocked out, the MISO pin shall be set high until the master finishes the SPI transaction. This is the functional equivalent of padding the end of anOutputBuf with 0xFF bytes out to the length of the transaction.</p>
<p>Once anInputBufLen bytes of anInputBuf have been clocked in from MOSI, all subsequent values from the MOSI pin are ignored until the SPI master finishes the transaction.</p>
<p>Note that even if <code>anInputBufLen</code> or <code>anOutputBufLen</code> (or both) are exhausted before the SPI master finishes a transaction, the ongoing size of the transaction must still be kept track of to be passed to the transaction complete callback. For example, if <code>anInputBufLen</code> is equal to 10 and <code>anOutputBufLen</code> equal to 20 and the SPI master clocks out 30 bytes, the value 30 is passed to the transaction complete callback.</p>
<p>Any call to this function while a transaction is in progress will cause all of the arguments to be ignored and the return value to be ::kThreadError_Busy.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">anOutputBuf</td><td>Data to be written to MISO pin </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">anOutputBufLen</td><td>Size of the output buffer, in bytes </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">anInputBuf</td><td>Data to be read from MOSI pin </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">anInputBufLen</td><td>Size of the input buffer, in bytes </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">aRequestTransactionFlag</td><td>Set to true if host interrupt should be set</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">::kThreadError_None</td><td>Transaction was successfully prepared. </td></tr>
    <tr><td class="paramname">::kThreadError_Busy</td><td>A transaction is currently in progress. </td></tr>
    <tr><td class="paramname">::kThreadError_InvalidState</td><td><a class="el" href="../../d1/d88/group__spi-slave.html#gab202b9e8a3a12e7e738467c4693acd44" title="Initialize the SPI slave interface. ">otPlatSpiSlaveEnable()</a> hasn't been called. </td></tr>
  </table>
  </dd>
</dl>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d1/d88/group__spi-slave_ga545203c4c963f46b40586b830d817a45_icgraph.png" border="0" usemap="#d1/d88/group__spi-slave_ga545203c4c963f46b40586b830d817a45_icgraph" alt=""/></div>
<map name="d1/d88/group__spi-slave_ga545203c4c963f46b40586b830d817a45_icgraph" id="d1/d88/group__spi-slave_ga545203c4c963f46b40586b830d817a45_icgraph">
<area shape="rect" id="node2" href="../../d0/d2a/classThread_1_1NcpSpi.html#a755449adff7ec14f4985ac462c7914bd" title="Constructor. " alt="" coords="286,5,450,31"/>
<area shape="rect" id="node3" href="../../d0/d2a/classThread_1_1NcpSpi.html#ae9c67ca2e9b95ac4a4fa5650d44a2eed" title="This method finalizes and sends the current outbound frame. " alt="" coords="278,55,458,93"/>
</map>
</div>
</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Fri Oct 14 2016 08:44:35 for OpenThread by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
